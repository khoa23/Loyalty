# Hướng dẫn cập nhật Password Hash với BCrypt

## Lưu ý quan trọng
Sau khi cập nhật API login để sử dụng BCrypt, các password trong database cần được hash lại bằng BCrypt.

## Cách tạo BCrypt Hash

### Cách 1: Sử dụng C# Console App (Khuyến nghị)

Tạo một file C# tạm thời để generate hash:

```csharp
using BCrypt.Net;

// Hash password
string password = "your_password_here";
string hash = BCrypt.Net.BCrypt.HashPassword(password, 12);
Console.WriteLine($"BCrypt Hash: {hash}");
```

### Cách 2: Sử dụng Online Tool (Chỉ cho môi trường dev/test)
- Truy cập: https://bcrypt-generator.com/
- Nhập password và chọn work factor = 12
- Copy hash được tạo

### Cách 3: Sử dụng PowerShell (nếu có BCrypt module)

```powershell
# Cần cài đặt module BCrypt.Net trước
$password = "your_password_here"
$hash = [BCrypt.Net.BCrypt]::HashPassword($password, 12)
Write-Host $hash
```

## Cập nhật Database

Sau khi có BCrypt hash, cập nhật database:

```sql
-- Ví dụ: Cập nhật password cho user 'admin_loan'
-- Giả sử password gốc là 'admin123'
UPDATE loyalty_admin.users 
SET password_hash = '$2a$12$LQv3c1yqBWVHxkd0LHAkCOYz6TtxMQJqhN8/LewY5GyYqK5q5q5q5' 
WHERE username = 'admin_loan';

-- Cập nhật cho các user khác
UPDATE loyalty_admin.users 
SET password_hash = '$2a$12$...' 
WHERE username = 'khachhang_a';

UPDATE loyalty_admin.users 
SET password_hash = '$2a$12$...' 
WHERE username = 'khachhang_b';

UPDATE loyalty_admin.users 
SET password_hash = '$2a$12$...' 
WHERE username = 'khachhang_c';
```

## Lưu ý bảo mật
- **KHÔNG** lưu password plain text trong database
- **KHÔNG** commit password hash vào git (nếu là production)
- Mỗi lần hash cùng một password sẽ tạo ra hash khác nhau (do salt ngẫu nhiên)
- Work factor 12 là cân bằng tốt giữa bảo mật và hiệu suất

## Test API Login

Sau khi cập nhật, test API login với:
- Username: tên user trong database
- Password: password gốc (plain text) - API sẽ tự động hash và verify

