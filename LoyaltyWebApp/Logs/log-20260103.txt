2026-01-03 13:37:01.140 +07:00 [INF] Starting LoyaltyWebApp application
2026-01-03 13:37:03.749 +07:00 [INF] LoyaltyWebApp is starting up
2026-01-03 13:41:59.085 +07:00 [INF] Login API response status: "InternalServerError"
2026-01-03 13:41:59.089 +07:00 [WRN] Login API failed with status "InternalServerError": Npgsql.PostgresException (0x80004005): 42501: user dev_user does not have USAGE privilege on schema loyalty_admin
   at Npgsql.Internal.NpgsqlConnector.ReadMessageLong(Boolean async, DataRowLoadingMode dataRowLoadingMode, Boolean readingNotifications, Boolean isReadingPrependedMessage)
   at System.Runtime.CompilerServices.PoolingAsyncValueTaskMethodBuilder`1.StateMachineBox`1.System.Threading.Tasks.Sources.IValueTaskSource<TResult>.GetResult(Int16 token)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteDbDataReaderAsync(CommandBehavior behavior, CancellationToken cancellationToken)
   at Dapper.SqlMapper.QueryRowAsync[T](IDbConnection cnn, Row row, Type effectiveType, CommandDefinition command) in /_/Dapper/SqlMapper.Async.cs:line 489
   at LoyaltyAPI.Controllers.UserController.Login(LoginRequest request) in D:\Code\Loyalty\LoyaltyAPI\Controllers\UserController.cs:line 37
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.TaskOfIActionResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at LoyaltyAPI.Security.ApiKeyMiddleware.InvokeAsync(HttpContext context) in D:\Code\Loyalty\LoyaltyAPI\Security\ApiKeyMiddleware.cs:line 42
   at Swashbuckle.AspNetCore.SwaggerUI.SwaggerUIMiddleware.Invoke(HttpContext httpContext)
   at Swashbuckle.AspNetCore.Swagger.SwaggerMiddleware.Invoke(HttpContext httpContext, ISwaggerProvider swaggerProvider)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Diagnostics.DeveloperExceptionPageMiddlewareImpl.Invoke(HttpContext context)
  Exception data:
    Severity: ERROR
    SqlState: 42501
    MessageText: user dev_user does not have USAGE privilege on schema loyalty_admin
    File: errors.go
    Line: 527
    Routine: NewInsufficientPrivilegeOnDescriptorError

HEADERS
=======
Content-Type: application/json; charset=utf-8
Host: localhost:44343
Transfer-Encoding: chunked
X-API-KEY: MySuperSecretApiKey123
traceparent: 00-6795698a2e4457b1377a7a19caef7827-d3be35dfc927ab7a-00

2026-01-03 13:44:01.909 +07:00 [INF] Login API response status: "OK"
2026-01-03 13:44:01.909 +07:00 [INF] Login API response content: {"message":"Đăng nhập thành công","data":{"user_id":1138198698525917185,"username":"khachhang_a","user_role":"Customer","customer_id":1138198698634805249}}
2026-01-03 13:44:01.934 +07:00 [INF] Login successful for user: khachhang_a
2026-01-03 13:44:02.082 +07:00 [INF] GetCustomerRewardsWithPagination API response status: "OK"
2026-01-03 13:44:02.082 +07:00 [INF] GetCustomerRewardsWithPagination API response content: {"message":"Lấy danh sách quà thành công","data":[{"reward_Id":"1138198698694901761","reward_Name":"Bình Giữ Nhiệt Cao Cấp","description":"Bình giữ nhiệt dung tích 500ml","points_Cost":2500,"stock_Quantity":49,"image_Url":null,"is_Active":null,"updated_At":"2026-01-03T13:17:57.019596"}],"page":1,"pageSize":1,"totalCount":3,"totalPages":3,"hasNext":true,"hasPrevious":false}
2026-01-03 13:44:02.098 +07:00 [INF] GetCustomerRewardsWithPagination successful, page: 1, total: 3
2026-01-03 13:44:05.074 +07:00 [INF] GetRedemptionHistory API response status: "OK"
2026-01-03 13:44:05.074 +07:00 [INF] GetRedemptionHistory API response content: {"message":"Lấy lịch sử đổi quà thành công","data":[{"transaction_Id":"1138198698814242817","reward_Id":"1138198698694344705","reward_Name":"Voucher Điện Tử 100K","description":"Voucher sử dụng tại siêu thị","quantity_Redeemed":5,"points_Spent":5000,"redemption_Date":"2026-01-03T13:17:57.019596","transaction_Status":"Completed"}],"page":1,"pageSize":100,"totalCount":1,"hasMore":false}
2026-01-03 13:44:05.082 +07:00 [INF] GetRedemptionHistory successful for customer 1138198698634805249, page 1, pageSize 100, count 1
2026-01-03 13:44:23.385 +07:00 [INF] Login API response status: "OK"
2026-01-03 13:44:23.385 +07:00 [INF] Login API response content: {"message":"Đăng nhập thành công","data":{"user_id":1138198698525720577,"username":"admin_loan","user_role":"Admin","customer_id":null}}
2026-01-03 13:44:23.387 +07:00 [INF] Login successful for user: admin_loan
2026-01-03 13:44:23.435 +07:00 [INF] GetRewardsWithPagination API response status: "OK"
2026-01-03 13:44:23.435 +07:00 [INF] GetRewardsWithPagination API response content: {"message":"Lấy danh sách quà thành công","data":[{"reward_Id":"1138198698694344705","reward_Name":"Voucher Điện Tử 100K","description":"Voucher sử dụng tại siêu thị","points_Cost":1000,"stock_Quantity":95,"image_Url":null,"is_Active":true,"updated_At":"2026-01-03T13:17:57.019596"}],"page":1,"pageSize":1,"totalCount":3,"totalPages":3,"hasNext":true,"hasPrevious":false}
2026-01-03 13:44:23.439 +07:00 [INF] GetRewardsWithPagination successful, page: 1, total: 3
2026-01-03 18:59:13.734 +07:00 [INF] Starting LoyaltyWebApp application
2026-01-03 18:59:15.100 +07:00 [INF] LoyaltyWebApp is starting up
2026-01-03 18:59:34.432 +07:00 [INF] Login API response status: "InternalServerError"
2026-01-03 18:59:34.435 +07:00 [WRN] Login API failed with status "InternalServerError": Npgsql.NpgsqlException (0x80004005): Failed to connect to 127.0.0.1:26257
 ---> System.Net.Sockets.SocketException (10061): No connection could be made because the target machine actively refused it.
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.ThrowException(SocketError error, CancellationToken cancellationToken)
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.System.Threading.Tasks.Sources.IValueTaskSource.GetResult(Int16 token)
   at System.Net.Sockets.Socket.<ConnectAsync>g__WaitForConnectWithCancellation|285_0(AwaitableSocketAsyncEventArgs saea, ValueTask connectTask, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.ConnectAsync(NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.ConnectAsync(NpgsqlTimeout timeout, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.RawOpen(NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.<Open>g__OpenCore|209_0(NpgsqlConnector conn, String username, SslMode sslMode, GssEncryptionMode gssEncMode, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.Open(NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken)
   at Npgsql.PoolingDataSource.OpenNewConnector(NpgsqlConnection conn, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken)
   at Npgsql.PoolingDataSource.<Get>g__RentAsync|33_0(NpgsqlConnection conn, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken)
   at Npgsql.NpgsqlConnection.<Open>g__OpenAsync|42_0(Boolean async, CancellationToken cancellationToken)
   at Dapper.SqlMapper.QueryRowAsync[T](IDbConnection cnn, Row row, Type effectiveType, CommandDefinition command) in /_/Dapper/SqlMapper.Async.cs:line 488
   at LoyaltyAPI.Controllers.UserController.Login(LoginRequest request) in D:\Code\LoyaltyAPI\LoyaltyAPI\Controllers\UserController.cs:line 37
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.TaskOfIActionResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at LoyaltyAPI.Security.ApiKeyMiddleware.InvokeAsync(HttpContext context) in D:\Code\LoyaltyAPI\LoyaltyAPI\Security\ApiKeyMiddleware.cs:line 42
   at Swashbuckle.AspNetCore.SwaggerUI.SwaggerUIMiddleware.Invoke(HttpContext httpContext)
   at Swashbuckle.AspNetCore.Swagger.SwaggerMiddleware.Invoke(HttpContext httpContext, ISwaggerProvider swaggerProvider)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Diagnostics.DeveloperExceptionPageMiddlewareImpl.Invoke(HttpContext context)

HEADERS
=======
Content-Type: application/json; charset=utf-8
Host: localhost:44343
Transfer-Encoding: chunked
X-API-KEY: MySuperSecretApiKey123
traceparent: 00-656d0ab63325a8ccb9c1acd3f6aa5606-c1dd90a3d4bc43e7-00

2026-01-03 18:59:49.236 +07:00 [INF] Login API response status: "OK"
2026-01-03 18:59:49.236 +07:00 [INF] Login API response content: {"message":"Đăng nhập thành công","data":{"user_id":1134039809002635265,"username":"admin_loan","user_role":"Admin","customer_id":null}}
2026-01-03 18:59:49.252 +07:00 [INF] Login successful for user: admin_loan
2026-01-03 18:59:49.363 +07:00 [INF] GetRewardsWithPagination API response status: "OK"
2026-01-03 18:59:49.363 +07:00 [INF] GetRewardsWithPagination API response content: {"message":"Lấy danh sách quà thành công","data":[{"reward_Id":"1137730597178408961","reward_Name":"test2","description":"test2","points_Cost":1,"stock_Quantity":10,"image_Url":null,"is_Active":true,"updated_At":"2026-01-01T14:37:03.840839"}],"page":1,"pageSize":1,"totalCount":11,"totalPages":11,"hasNext":true,"hasPrevious":false}
2026-01-03 18:59:49.374 +07:00 [INF] GetRewardsWithPagination successful, page: 1, total: 11
2026-01-03 19:06:04.229 +07:00 [INF] Login API response status: "InternalServerError"
2026-01-03 19:06:04.229 +07:00 [WRN] Login API failed with status "InternalServerError": System.ArgumentException: Couldn't set port (Parameter 'port')
 ---> System.FormatException: The input string '26257,26258,26259' was not in a correct format.
   at System.Number.ThrowFormatException[TChar](ReadOnlySpan`1 value)
   at System.String.System.IConvertible.ToInt32(IFormatProvider provider)
   at System.Convert.ChangeType(Object value, Type conversionType, IFormatProvider provider)
   at Npgsql.NpgsqlConnectionStringBuilder.GeneratedActions(GeneratedAction action, String keyword, Object& value)
   at Npgsql.NpgsqlConnectionStringBuilder.set_Item(String keyword, Object value)
   --- End of inner exception stack trace ---
   at Npgsql.NpgsqlConnectionStringBuilder.set_Item(String keyword, Object value)
   at System.Data.Common.DbConnectionStringBuilder.set_ConnectionString(String value)
   at Npgsql.NpgsqlConnectionStringBuilder..ctor(String connectionString)
   at Npgsql.NpgsqlConnection.SetupDataSource()
   at Npgsql.NpgsqlConnection.set_ConnectionString(String value)
   at Npgsql.NpgsqlConnection..ctor(String connectionString)
   at LoyaltyAPI.Controllers.UserController.Login(LoginRequest request) in D:\Code\LoyaltyAPI\LoyaltyAPI\Controllers\UserController.cs:line 34
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.TaskOfIActionResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.InvokeInnerFilterAsync()
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at LoyaltyAPI.Security.ApiKeyMiddleware.InvokeAsync(HttpContext context) in D:\Code\LoyaltyAPI\LoyaltyAPI\Security\ApiKeyMiddleware.cs:line 42
   at Swashbuckle.AspNetCore.SwaggerUI.SwaggerUIMiddleware.Invoke(HttpContext httpContext)
   at Swashbuckle.AspNetCore.Swagger.SwaggerMiddleware.Invoke(HttpContext httpContext, ISwaggerProvider swaggerProvider)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Diagnostics.DeveloperExceptionPageMiddlewareImpl.Invoke(HttpContext context)

HEADERS
=======
Content-Type: application/json; charset=utf-8
Host: localhost:44343
Transfer-Encoding: chunked
X-API-KEY: MySuperSecretApiKey123
traceparent: 00-c5a3d963b1ff9ad4cb86c8c44d62556a-4f229c5f43c36d24-00

2026-01-03 19:07:10.573 +07:00 [INF] Login API response status: "OK"
2026-01-03 19:07:10.573 +07:00 [INF] Login API response content: {"message":"Đăng nhập thành công","data":{"user_id":1134039809002635265,"username":"admin_loan","user_role":"Admin","customer_id":null}}
2026-01-03 19:07:10.574 +07:00 [INF] Login successful for user: admin_loan
2026-01-03 19:07:10.644 +07:00 [INF] GetRewardsWithPagination API response status: "OK"
2026-01-03 19:07:10.645 +07:00 [INF] GetRewardsWithPagination API response content: {"message":"Lấy danh sách quà thành công","data":[{"reward_Id":"1137730597178408961","reward_Name":"test2","description":"test2","points_Cost":1,"stock_Quantity":10,"image_Url":null,"is_Active":true,"updated_At":"2026-01-01T14:37:03.840839"}],"page":1,"pageSize":1,"totalCount":11,"totalPages":11,"hasNext":true,"hasPrevious":false}
2026-01-03 19:07:10.647 +07:00 [INF] GetRewardsWithPagination successful, page: 1, total: 11
2026-01-03 19:07:33.143 +07:00 [INF] Login API response status: "OK"
2026-01-03 19:07:33.143 +07:00 [INF] Login API response content: {"message":"Đăng nhập thành công","data":{"user_id":1134039809002635265,"username":"admin_loan","user_role":"Admin","customer_id":null}}
2026-01-03 19:07:33.144 +07:00 [INF] Login successful for user: admin_loan
2026-01-03 19:07:33.178 +07:00 [INF] GetRewardsWithPagination API response status: "OK"
2026-01-03 19:07:33.178 +07:00 [INF] GetRewardsWithPagination API response content: {"message":"Lấy danh sách quà thành công","data":[{"reward_Id":"1137730597178408961","reward_Name":"test2","description":"test2","points_Cost":1,"stock_Quantity":10,"image_Url":null,"is_Active":true,"updated_At":"2026-01-01T14:37:03.840839"}],"page":1,"pageSize":1,"totalCount":11,"totalPages":11,"hasNext":true,"hasPrevious":false}
2026-01-03 19:07:33.179 +07:00 [INF] GetRewardsWithPagination successful, page: 1, total: 11
2026-01-03 19:09:03.544 +07:00 [INF] Login API response status: "OK"
2026-01-03 19:09:03.544 +07:00 [INF] Login API response content: {"message":"Đăng nhập thành công","data":{"user_id":1134039809002635265,"username":"admin_loan","user_role":"Admin","customer_id":null}}
2026-01-03 19:09:03.545 +07:00 [INF] Login successful for user: admin_loan
2026-01-03 19:09:03.595 +07:00 [INF] GetRewardsWithPagination API response status: "OK"
2026-01-03 19:09:03.595 +07:00 [INF] GetRewardsWithPagination API response content: {"message":"Lấy danh sách quà thành công","data":[{"reward_Id":"1137730597178408961","reward_Name":"test2","description":"test2","points_Cost":1,"stock_Quantity":10,"image_Url":null,"is_Active":true,"updated_At":"2026-01-01T14:37:03.840839"}],"page":1,"pageSize":1,"totalCount":11,"totalPages":11,"hasNext":true,"hasPrevious":false}
2026-01-03 19:09:03.598 +07:00 [INF] GetRewardsWithPagination successful, page: 1, total: 11
2026-01-03 19:12:24.256 +07:00 [INF] GetRewardsWithPagination API response status: "OK"
2026-01-03 19:12:24.256 +07:00 [INF] GetRewardsWithPagination API response content: {"message":"Lấy danh sách quà thành công","data":[{"reward_Id":"1137730597178408961","reward_Name":"test2","description":"test2","points_Cost":1,"stock_Quantity":10,"image_Url":null,"is_Active":true,"updated_At":"2026-01-01T14:37:03.840839"}],"page":1,"pageSize":1,"totalCount":11,"totalPages":11,"hasNext":true,"hasPrevious":false}
2026-01-03 19:12:24.258 +07:00 [INF] GetRewardsWithPagination successful, page: 1, total: 11
2026-01-03 19:12:36.030 +07:00 [INF] Login API response status: "InternalServerError"
2026-01-03 19:12:36.030 +07:00 [WRN] Login API failed with status "InternalServerError": System.InvalidCastException: Reading as 'System.String' is not supported for fields having DataTypeName 'inet'
   at Npgsql.Internal.AdoSerializerHelpers.<GetTypeInfoForReading>g__ThrowReadingNotSupported|0_0(Type type, PgSerializerOptions options, PgTypeId pgTypeId, Exception inner)
   at Npgsql.Internal.AdoSerializerHelpers.GetTypeInfoForReading(Type type, PgTypeId pgTypeId, PgSerializerOptions options)
   at Npgsql.BackendMessages.FieldDescription.<GetInfoCore>g__GetInfoSlow|51_0(Type type, ColumnInfo& lastColumnInfo)
   at Npgsql.BackendMessages.FieldDescription.GetInfoCore(Type type, ColumnInfo& lastColumnInfo)
   at Npgsql.BackendMessages.FieldDescription.GetInfo(Type type, ColumnInfo& lastColumnInfo)
   at Npgsql.NpgsqlDataReader.<GetInfo>g__Slow|132_0(ColumnInfo& info, PgConverter& converter, Size& bufferRequirement, Boolean& asObject, <>c__DisplayClass132_0&)
   at Npgsql.NpgsqlDataReader.GetFieldValueCore[T](Int32 ordinal)
   at Npgsql.NpgsqlDataReader.GetString(Int32 ordinal)
   at LoyaltyAPI.Helpers.ConnectionHelper.OpenWithLoggingAsync(IDbConnection connection, ILogger logger) in D:\Code\LoyaltyAPI\LoyaltyAPI\Helpers\ConnectionHelper.cs:line 28
   at LoyaltyAPI.Controllers.UserController.Login(LoginRequest request) in D:\Code\LoyaltyAPI\LoyaltyAPI\Controllers\UserController.cs:line 36
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.TaskOfIActionResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at LoyaltyAPI.Security.ApiKeyMiddleware.InvokeAsync(HttpContext context) in D:\Code\LoyaltyAPI\LoyaltyAPI\Security\ApiKeyMiddleware.cs:line 42
   at Swashbuckle.AspNetCore.SwaggerUI.SwaggerUIMiddleware.Invoke(HttpContext httpContext)
   at Swashbuckle.AspNetCore.Swagger.SwaggerMiddleware.Invoke(HttpContext httpContext, ISwaggerProvider swaggerProvider)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Diagnostics.DeveloperExceptionPageMiddlewareImpl.Invoke(HttpContext context)

HEADERS
=======
Content-Type: application/json; charset=utf-8
Host: localhost:44343
Transfer-Encoding: chunked
X-API-KEY: MySuperSecretApiKey123
traceparent: 00-3aad6539ab03422fbedbf743226d5900-48c7d39d10e540f7-00

2026-01-03 19:13:00.510 +07:00 [INF] Login API response status: "InternalServerError"
2026-01-03 19:13:00.510 +07:00 [WRN] Login API failed with status "InternalServerError": System.InvalidCastException: Reading as 'System.String' is not supported for fields having DataTypeName 'inet'
   at Npgsql.Internal.AdoSerializerHelpers.<GetTypeInfoForReading>g__ThrowReadingNotSupported|0_0(Type type, PgSerializerOptions options, PgTypeId pgTypeId, Exception inner)
   at Npgsql.Internal.AdoSerializerHelpers.GetTypeInfoForReading(Type type, PgTypeId pgTypeId, PgSerializerOptions options)
   at Npgsql.BackendMessages.FieldDescription.<GetInfoCore>g__GetInfoSlow|51_0(Type type, ColumnInfo& lastColumnInfo)
   at Npgsql.BackendMessages.FieldDescription.GetInfoCore(Type type, ColumnInfo& lastColumnInfo)
   at Npgsql.BackendMessages.FieldDescription.GetInfo(Type type, ColumnInfo& lastColumnInfo)
   at Npgsql.NpgsqlDataReader.<GetInfo>g__Slow|132_0(ColumnInfo& info, PgConverter& converter, Size& bufferRequirement, Boolean& asObject, <>c__DisplayClass132_0&)
   at Npgsql.NpgsqlDataReader.GetFieldValueCore[T](Int32 ordinal)
   at Npgsql.NpgsqlDataReader.GetString(Int32 ordinal)
   at LoyaltyAPI.Helpers.ConnectionHelper.OpenWithLoggingAsync(IDbConnection connection, ILogger logger) in D:\Code\LoyaltyAPI\LoyaltyAPI\Helpers\ConnectionHelper.cs:line 28
   at LoyaltyAPI.Controllers.UserController.Login(LoginRequest request) in D:\Code\LoyaltyAPI\LoyaltyAPI\Controllers\UserController.cs:line 36
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.TaskOfIActionResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at LoyaltyAPI.Security.ApiKeyMiddleware.InvokeAsync(HttpContext context) in D:\Code\LoyaltyAPI\LoyaltyAPI\Security\ApiKeyMiddleware.cs:line 42
   at Swashbuckle.AspNetCore.SwaggerUI.SwaggerUIMiddleware.Invoke(HttpContext httpContext)
   at Swashbuckle.AspNetCore.Swagger.SwaggerMiddleware.Invoke(HttpContext httpContext, ISwaggerProvider swaggerProvider)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Diagnostics.DeveloperExceptionPageMiddlewareImpl.Invoke(HttpContext context)

HEADERS
=======
Content-Type: application/json; charset=utf-8
Host: localhost:44343
Transfer-Encoding: chunked
X-API-KEY: MySuperSecretApiKey123
traceparent: 00-a48a5e4a5492f93035aee69b31b66392-1a4bacafd01eea14-00

2026-01-03 19:17:03.501 +07:00 [INF] Login API response status: "OK"
2026-01-03 19:17:03.501 +07:00 [INF] Login API response content: {"message":"Đăng nhập thành công","data":{"user_id":1134039809002635265,"username":"admin_loan","user_role":"Admin","customer_id":null}}
2026-01-03 19:17:03.502 +07:00 [INF] Login successful for user: admin_loan
2026-01-03 19:17:03.592 +07:00 [INF] GetRewardsWithPagination API response status: "OK"
2026-01-03 19:17:03.593 +07:00 [INF] GetRewardsWithPagination API response content: {"message":"Lấy danh sách quà thành công","data":[{"reward_Id":"1137730597178408961","reward_Name":"test2","description":"test2","points_Cost":1,"stock_Quantity":10,"image_Url":null,"is_Active":true,"updated_At":"2026-01-01T14:37:03.840839"}],"page":1,"pageSize":1,"totalCount":11,"totalPages":11,"hasNext":true,"hasPrevious":false}
2026-01-03 19:17:03.595 +07:00 [INF] GetRewardsWithPagination successful, page: 1, total: 11
2026-01-03 19:18:12.278 +07:00 [INF] Login API response status: "OK"
2026-01-03 19:18:12.278 +07:00 [INF] Login API response content: {"message":"Đăng nhập thành công","data":{"user_id":1134039809002635265,"username":"admin_loan","user_role":"Admin","customer_id":null}}
2026-01-03 19:18:12.278 +07:00 [INF] Login successful for user: admin_loan
2026-01-03 19:18:12.306 +07:00 [INF] GetRewardsWithPagination API response status: "OK"
2026-01-03 19:18:12.306 +07:00 [INF] GetRewardsWithPagination API response content: {"message":"Lấy danh sách quà thành công","data":[{"reward_Id":"1137730597178408961","reward_Name":"test2","description":"test2","points_Cost":1,"stock_Quantity":10,"image_Url":null,"is_Active":true,"updated_At":"2026-01-01T14:37:03.840839"}],"page":1,"pageSize":1,"totalCount":11,"totalPages":11,"hasNext":true,"hasPrevious":false}
2026-01-03 19:18:12.307 +07:00 [INF] GetRewardsWithPagination successful, page: 1, total: 11
2026-01-03 19:18:43.277 +07:00 [INF] Login API response status: "OK"
2026-01-03 19:18:43.277 +07:00 [INF] Login API response content: {"message":"Đăng nhập thành công","data":{"user_id":1134039809002635265,"username":"admin_loan","user_role":"Admin","customer_id":null}}
2026-01-03 19:18:43.278 +07:00 [INF] Login successful for user: admin_loan
2026-01-03 19:18:43.315 +07:00 [INF] GetRewardsWithPagination API response status: "OK"
2026-01-03 19:18:43.315 +07:00 [INF] GetRewardsWithPagination API response content: {"message":"Lấy danh sách quà thành công","data":[{"reward_Id":"1137730597178408961","reward_Name":"test2","description":"test2","points_Cost":1,"stock_Quantity":10,"image_Url":null,"is_Active":true,"updated_At":"2026-01-01T14:37:03.840839"}],"page":1,"pageSize":1,"totalCount":11,"totalPages":11,"hasNext":true,"hasPrevious":false}
2026-01-03 19:18:43.318 +07:00 [INF] GetRewardsWithPagination successful, page: 1, total: 11
